runner:
  benchmark:
    tests:
      metadata:
        labels:
          name: mainnet-24350000-stateful
          chain: mainnet
          block: "24350000"
          test-type: stateful
      source:
        git:
          repo: https://github.com/nethermindeth/gas-benchmarks.git
          version: e5011aa5f75d7a1722481f25408347fadfb7fd3c
          pre_run_steps:
            - repricings_stateful/mainnet/gas-bump.txt
            - repricings_stateful/mainnet/funding.txt
          steps:
            setup:
              - repricings_stateful/mainnet/setup/*
            test:
              - repricings_stateful/mainnet/testing/*
            cleanup:
              - repricings_stateful/mainnet/cleanup/*

  # Use podman + checkpoint/restore via CRIU
  container_runtime: podman
  client:
    config:
      rollback_strategy: container-checkpoint-restore
      checkpoint_restore_strategy_options:
        tmpfs_threshold: "10g"
        tmpfs_max_size: "15g"
        wait_after_tcp_drop_connections: 10s
        restart_container: true
